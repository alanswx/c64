/*-------------------------------------------------------------------------------*\||	File:	CPUState.c||	Description:||||||	Copyright ï¿½	1994, Alan Steremberg and Ed Wynne|\*-------------------------------------------------------------------------------*/#include "Accessors.h"#include "Memory.h"#include "Interrupts.h"#include "ASMCPU.h"#include "CPUState.h"/*	local constants/macros	*/#define	kResetVector		0xFFFC#define	kIRQVector			0xFFFE#define	kBRKVector			0xFFFE/* local globals	*/unsigned long	gACCRegister;unsigned long	gINXRegister;unsigned long	gINYRegister;unsigned long	gSTACKRegister;unsigned long	gPCRegister;unsigned long	gSRRegister;unsigned long	gTraceMode;extern ReadHandler			*gMemRead;							//	Memory.cextern WriteHandler			*gMemWrite;							//	Memory.cextern unsigned char			*gRAMBlock;							//	Memory.cvoid ResetCPUState(void){	gTraceMode = 0;		gSTACKRegister = 255;	gSRRegister = 0x20;	    unsigned char a = MEMREADBYTE(kResetVector);    unsigned char b = MEMREADBYTE(kResetVector+1);    	gPCRegister = MEMREADWORD(kResetVector);    fprintf(stderr,"reset: a %x b %x pc %x pcab %x pcba %x\n",a,b,gPCRegister,a<<8|b,b<<8|a);    	MEMWRITEBYTE(0xDD00,0x03);	MEMWRITEBYTE(0xD018,0x14);		SetRasterLineInterruptCounter(127);	SetCPUTimingInterruptCounter(1000000);}